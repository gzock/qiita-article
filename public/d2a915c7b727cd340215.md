---
title: SASEが導入されたmacOS環境でBambu Studioを動かす
tags:
  - 3Dプリンタ
private: false
updated_at: '2025-12-15T22:32:05+09:00'
id: d2a915c7b727cd340215
organization_url_name: null
slide: false
ignorePublish: false
---
# 概要

- とある条件を満たすときBambu Studioが正常に動かないことがある
- 不具合に近いものなのだがまぁワークアラウンドがあるのでご紹介

# 条件

- Bambu Lab の 3Dプリンターを使っている
- Bambu Studioを使って3Dプリンティングしている
- 社内NWでNetskopeなどのミドルボックス的に動くSASE/CASB的なツールを導入している
- macOSを使っている

# 環境

以下の環境ではこのワークアラウンドでうまくいくことを確認済み。

- Bambu Studio v2.3.1.51
- macOS Sequoia 15.5

# 問題の挙動

- Syncができない

![貼り付けた画像_2025_12_15_22_23.jpg](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/80163/a758c7c1-980d-4bd0-ad98-9f833bbbf336.jpeg)


- 登録されているはずの3Dプリンターが表示されない

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/80163/c34d38e9-46d5-40fd-afbc-1d3b8cc4222f.png)


- Help > Open Network Testがコケる

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/80163/4a1a7af4-2b04-4375-aa57-d9c5c860e441.png)

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/80163/34c74e4c-495b-4c66-ad63-03e883ca589f.png)

こんな感じのエラーが表示されている。つまるところ自己証明書だから検証できひんよっていうこと。

```text
Mon Dec 15 15:45:46:[test_bambulab]: url=https://api.bambulab.com/v1/iot-service/api/slicer/resource?name=slicer&version=02.03.01.51&guide_version=00.00.00.01
Mon Dec 15 15:45:46:test bambulab failed
Mon Dec 15 15:45:46:status=0, body=, error=curl:SSL peer certificate or SSH remote key was not OK:
SSL certificate problem: self-signed certificate in certificate chain
[Error 60]
```

# ワークアラウンド

以下のパスに記載のファイルにSASE/CASBのCA証明書ファイルを追記する

- https://github.com/bambulab/BambuStudio/blob/7e075f71be1516c110f9952d6a0b103d10a4777d/src/slic3r/Utils/Http.cpp#L39-L47

```text
            "/etc/pki/tls/certs/ca-bundle.crt",   // Fedora/RHEL 6
            "/etc/ssl/certs/ca-certificates.crt", // Debian/Ubuntu/Gentoo etc.
            "/usr/share/ssl/certs/ca-bundle.crt",
            "/usr/local/share/certs/ca-root-nss.crt", // FreeBSD
            "/etc/ssl/cert.pem",
            "/etc/ssl/ca-bundle.pem"    
```

- 例えばこんな感じ

```
$ sudo cat your_ca_cert.pem >> /etc/ssl/cert.pem
```

## 動作確認

- ばっちり成功

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/80163/b97ce527-1410-4274-94b8-a1a41d12a171.png)

# なぜ？

- SASE環境の場合、OSのキーチェーンに既にCA証明書がインポートされていると思う
    - Bambu StudioのHTTPクライアントがどうもそこを参照してくれてないみたい
- 自分の周りのWindows環境だと特にこういった小細工なく普通にうまくいってる
- 不具合っぽいし、まぁそこそこ困るっちゃ困るので、あとで時間あるときに自分で直してPRだそうと思う
  - 取り急ぎワークアラウンド適用でどうにかなっちゃったのでそんなに困っておらず優先度は低い

# 参考

- [自分で困ったので調べて解決していたのだがIssueでそれっぽく困ってる人がいたのでコメントしておいた](https://github.com/bambulab/BambuStudio/issues/6071#issuecomment-3263797377)
